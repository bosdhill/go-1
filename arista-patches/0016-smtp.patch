diff --git a/src/net/smtp/smtp_test.go b/src/net/smtp/smtp_test.go
index f23fd79234..756f58bca2 100644
--- a/src/net/smtp/smtp_test.go
+++ b/src/net/smtp/smtp_test.go
@@ -1105,40 +1105,57 @@ func sendMail(hostPort string) error {
 
 // localhostCert is a PEM-encoded TLS cert generated from src/crypto/tls:
 //
-//	go run generate_cert.go --rsa-bits 1024 --host 127.0.0.1,::1,example.com \
+//	go run generate_cert.go --rsa-bits 2048 --host 127.0.0.1,::1,example.com \
 //		--ca --start-date "Jan 1 00:00:00 1970" --duration=1000000h
 var localhostCert = []byte(`
 -----BEGIN CERTIFICATE-----
-MIICFDCCAX2gAwIBAgIRAK0xjnaPuNDSreeXb+z+0u4wDQYJKoZIhvcNAQELBQAw
-EjEQMA4GA1UEChMHQWNtZSBDbzAgFw03MDAxMDEwMDAwMDBaGA8yMDg0MDEyOTE2
-MDAwMFowEjEQMA4GA1UEChMHQWNtZSBDbzCBnzANBgkqhkiG9w0BAQEFAAOBjQAw
-gYkCgYEA0nFbQQuOWsjbGtejcpWz153OlziZM4bVjJ9jYruNw5n2Ry6uYQAffhqa
-JOInCmmcVe2siJglsyH9aRh6vKiobBbIUXXUU1ABd56ebAzlt0LobLlx7pZEMy30
-LqIi9E6zmL3YvdGzpYlkFRnRrqwEtWYbGBf3znO250S56CCWH2UCAwEAAaNoMGYw
-DgYDVR0PAQH/BAQDAgKkMBMGA1UdJQQMMAoGCCsGAQUFBwMBMA8GA1UdEwEB/wQF
-MAMBAf8wLgYDVR0RBCcwJYILZXhhbXBsZS5jb22HBH8AAAGHEAAAAAAAAAAAAAAA
-AAAAAAEwDQYJKoZIhvcNAQELBQADgYEAbZtDS2dVuBYvb+MnolWnCNqvw1w5Gtgi
-NmvQQPOMgM3m+oQSCPRTNGSg25e1Qbo7bgQDv8ZTnq8FgOJ/rbkyERw2JckkHpD4
-n4qcK27WkEDBtQFlPihIM8hLIuzWoi/9wygiElTy/tVL3y7fGCvY2/k1KBthtZGF
-tN8URjVmyEo=
+MIIDGDCCAgCgAwIBAgIQU5OlhjL1YcfZk2761W75yTANBgkqhkiG9w0BAQsFADAS
+MRAwDgYDVQQKEwdBY21lIENvMCAXDTcwMDEwMTAwMDAwMFoYDzIwODQwMTI5MTYw
+MDAwWjASMRAwDgYDVQQKEwdBY21lIENvMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
+MIIBCgKCAQEArpZP5u/sz+XiGvLt/LHTgbjqyUW64ByVYs8EnDGK/3k+ol4WPDGm
+1QzbnpnF6NjnZjwEIFcL6QhlOPi5O041QlpNl9EfuzuyFHXS5NVPHakkk/T085RH
+ZisL+LPOHRMAQzMVKyRyOxFGwJ5qiLIPskGm/BrXC0SG/70M9QYukTTQL2ooNoRU
+qcaVtWY/ugy0z6SKcmDMXiL91Q7JNIwHopoa1La0Txs39T/5om9lU9TRSqDFUo1q
+hcdtaa1uzutLIhf/TVwqvmsblptXAfzil+BWivT0esImwlDjUXDAkvPGluRxl6bj
+q06nfod1lmaqmPTNC5jWmBhRWATx6kGfhwIDAQABo2gwZjAOBgNVHQ8BAf8EBAMC
+AqQwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDwYDVR0TAQH/BAUwAwEB/zAuBgNVHREE
+JzAlggtleGFtcGxlLmNvbYcEfwAAAYcQAAAAAAAAAAAAAAAAAAAAATANBgkqhkiG
+9w0BAQsFAAOCAQEAWOnyu0x/2PGW05G3Rr8zVT6YzFWk+L4rNpdA00khMaovtzbe
+I7s7LN13wSmC7yHqGUxCq4XE++ou6sdlajME5GMUJ3afrnf+LLla3GEh29gs+bf1
+br847PzqbPfJquyF8TXmDXfV8T2e13TaBmI5B0sZPBoHuwDiLr3EycZv5QtoUNJk
+YWR4zO8EzQ34g1AeAvQ0TEzyiyViWCrBwFs3jqh1CGfcBtgh3fDxLVdMuMztrZE0
+KbU6ZnFLl9scGPHJI2GnbhDZJl8vtJmMq0RHxHFJT0B8bcBo9l79ufpC/VfjYiZr
+keVcN04N5iWsy1HYeORKmFCk7TCcvWO5P153pQ==
 -----END CERTIFICATE-----`)
 
 // localhostKey is the private key for localhostCert.
 var localhostKey = []byte(testingKey(`
 -----BEGIN RSA TESTING KEY-----
-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
+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
 -----END RSA TESTING KEY-----`))
 
 func testingKey(s string) string { return strings.ReplaceAll(s, "TESTING KEY", "PRIVATE KEY") }
